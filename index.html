<!DOCTYPE html>
<html lang="en" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- SECURITY: Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="
      default-src 'self';
      script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.tailwindcss.com https://esm.sh;
      style-src 'self' 'unsafe-inline';
      img-src 'self' data: https: blob:;
      font-src 'self' data:;
      connect-src 'self' https://api.github.com https://api.openai.com https://api.anthropic.com https://generativelanguage.googleapis.com https://api.deepseek.com https://esm.sh wss: ws:;
      frame-src 'none';
      object-src 'none';
      base-uri 'self';
    " />
    <title>GitKraken-ish Desktop</title>
    <!-- Keeping Tailwind CDN for simplicity in this setup without PostCSS config files -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            colors: {
              gk: {
                bg: '#1b1d23',
                panel: '#252833',
                header: '#14161b',
                accent: '#00cc74', // GitKraken Green
                green: '#00cc74', // Alias for accent
                blue: '#4d95ec',
                cyan: '#22d3ee', // Cyan for pull operations
                purple: '#af7bf0',
                yellow: '#fbc02d',
                red: '#ff5252',
                text: '#9ca3af',
                textLight: '#e5e7eb',
                line: '#34384b'
              }
            },
            fontFamily: {
              mono: ['ui-monospace', 'SFMono-Regular', 'Menlo', 'Monaco', 'Consolas', "Liberation Mono", "Courier New", 'monospace'],
            }
          }
        }
      }
    </script>
    <style>
      /* Custom Scrollbar to match GitKraken - WebKit (Chrome, Edge, Safari) */
      ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
      }
      ::-webkit-scrollbar-track {
        background: #1b1d23;
      }
      ::-webkit-scrollbar-thumb {
        background: #3f4455;
        border-radius: 5px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #4f5569;
      }

      /* Firefox scrollbar styling */
      * {
        scrollbar-width: thin;
        scrollbar-color: #3f4455 #1b1d23;
      }

      /* Standard scrollbar for browsers that support it */
      body {
        background-color: #1b1d23;
        color: #e5e7eb;
        overflow: hidden; /* App-like feel */
        user-select: none; /* Desktop app feel */
      }

      /* Custom scrollbar utility class */
      .custom-scrollbar {
        scrollbar-width: thin;
        scrollbar-color: #3f4455 #1b1d23;
      }

      .custom-scrollbar::-webkit-scrollbar {
        width: 10px;
        height: 10px;
      }

      .custom-scrollbar::-webkit-scrollbar-track {
        background: #1b1d23;
      }

      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: #3f4455;
        border-radius: 5px;
      }

      .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: #4f5569;
      }

      /* Draggable region for the custom title bar */
      .titlebar-drag {
        -webkit-app-region: drag;
      }
      button, input, .no-drag {
        -webkit-app-region: no-drag;
      }

      /* Modal Animations */
      @keyframes modalFadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes modalScaleIn {
        from {
          opacity: 0;
          transform: scale(0.95);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      .animate-fade-in {
        animation: modalFadeIn 0.2s ease-out;
      }

      .animate-scale-in {
        animation: modalScaleIn 0.2s ease-out;
      }

      /* Invalid drop target */
      .drop-invalid {
        background: repeating-linear-gradient(
          45deg,
          transparent,
          transparent 10px,
          rgba(255, 82, 82, 0.1) 10px,
          rgba(255, 82, 82, 0.1) 20px
        );
      }

      .drop-valid {
        background: rgba(0, 204, 116, 0.1);
      }

      /* Loading Screen Animation */
      @keyframes loading-pulse {
        0%, 100% { opacity: 0.4; transform: scale(0.95); }
        50% { opacity: 1; transform: scale(1); }
      }

      @keyframes loading-bar {
        0% { width: 0%; left: 0; }
        50% { width: 100%; left: 0; }
        100% { width: 0%; left: 100%; }
      }

      @keyframes loading-spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      @keyframes logo-glow {
        0%, 100% { filter: drop-shadow(0 0 8px rgba(0, 204, 116, 0.4)); }
        50% { filter: drop-shadow(0 0 20px rgba(0, 204, 116, 0.8)); }
      }

      .loading-screen {
        position: fixed;
        inset: 0;
        background: linear-gradient(135deg, #1b1d23 0%, #14161b 50%, #1b1d23 100%);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
      }

      .loading-screen.hidden {
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
      }

      .loading-logo {
        width: 96px;
        height: 96px;
        animation: logo-glow 2s ease-in-out infinite;
      }

      .loading-logo img {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }

      .loading-title {
        margin-top: 24px;
        font-size: 24px;
        font-weight: 600;
        color: #e5e7eb;
        letter-spacing: -0.5px;
      }

      .loading-subtitle {
        margin-top: 8px;
        font-size: 14px;
        color: #9ca3af;
      }

      .loading-bar-container {
        margin-top: 32px;
        width: 280px;
        height: 3px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 2px;
        overflow: hidden;
        position: relative;
      }

      .loading-bar {
        position: absolute;
        height: 100%;
        background: linear-gradient(90deg, #00cc74, #00cc74);
        border-radius: 2px;
        animation: loading-bar 1.5s ease-in-out infinite;
      }

      .loading-spinner {
        margin-top: 24px;
        width: 32px;
        height: 32px;
        border: 2px solid rgba(0, 204, 116, 0.2);
        border-top-color: #00cc74;
        border-radius: 50%;
        animation: loading-spin 0.8s linear infinite;
      }

      .loading-dots {
        display: flex;
        gap: 6px;
        margin-top: 16px;
      }

      .loading-dot {
        width: 6px;
        height: 6px;
        background: #00cc74;
        border-radius: 50%;
        animation: loading-pulse 1.4s ease-in-out infinite;
      }

      .loading-dot:nth-child(2) { animation-delay: 0.2s; }
      .loading-dot:nth-child(3) { animation-delay: 0.4s; }
    </style>
  <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/",
    "@google/genai": "https://esm.sh/@google/genai@^1.38.0",
    "lucide-react": "https://esm.sh/lucide-react@^0.563.0",
    "isomorphic-git": "https://esm.sh/isomorphic-git@^1.36.3",
    "isomorphic-git/": "https://esm.sh/isomorphic-git@^1.36.3/",
    "vite": "https://esm.sh/vite@^7.3.1",
    "@vitejs/plugin-react": "https://esm.sh/@vitejs/plugin-react@^5.1.2"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
  <body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
      <div class="loading-logo">
        <img src="/build/icon.png" alt="GitKraken-ish" />
      </div>
      <div class="loading-title">GitKraken-ish</div>
      <div class="loading-subtitle">Loading your Git experience...</div>
      <div class="loading-bar-container">
        <div class="loading-bar"></div>
      </div>
      <div class="loading-dots">
        <div class="loading-dot"></div>
        <div class="loading-dot"></div>
        <div class="loading-dot"></div>
      </div>
    </div>

    <div id="root"></div>
    <script type="module" src="/index.tsx"></script>
    <script>
      // Hide loading screen when app is ready
      window.addEventListener('load', () => {
        setTimeout(() => {
          const loadingScreen = document.getElementById('loading-screen');
          if (loadingScreen) {
            loadingScreen.classList.add('hidden');
          }
        }, 1500); // Show loading screen for at least 1.5s for smooth experience
      });
    </script>
  </body>
</html>
